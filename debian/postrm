#!/bin/sh
# SPDX-License-Identifier: MIT
# (C) 2025 Linux T2 Kernel Team
# Same removals as uninstall.sh (see INSTALL_PATHS.md). Runs as root, no sudo.

if [ "$1" != "remove" ] && [ "$1" != "purge" ]; then
  exit 0
fi

echo "Removing WirePlumber DSP config from /etc/wireplumber/wireplumber.conf.d"
rm -f /etc/wireplumber/wireplumber.conf.d/*-dsp.conf

echo "Removing old PipeWire config if present"
rm -f /etc/pipewire/pipewire.conf.d/10-t2_161_*.conf
rm -f /etc/pipewire/pipewire.conf.d/*-t2-dsp.conf

echo "Removing Lua script symlinks from /usr/share/wireplumber/scripts/device"
rm -f /usr/share/wireplumber/scripts/device/t2-force-unmute.lua

echo "Removing audio data (FIRs, graphs, Lua) from /usr/share/t2-linux-audio"
rm -rf /usr/share/t2-linux-audio

echo "To apply: systemctl --user restart wireplumber pipewire pipewire-pulse"

exit 0
